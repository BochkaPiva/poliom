#!/usr/bin/env python3
"""
–ü—Ä–æ—Å—Ç–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
"""

def is_blocked_response(response: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –æ—Ç–≤–µ—Ç GigaChat"""
    blocked_phrases = [
        "–ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ –æ–±–ª–∞–¥–∞—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –º–Ω–µ–Ω–∏–µ–º",
        "—Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã",
        "—Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–º—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã",
        "–ö–∞–∫ –∏ –ª—é–±–∞—è —è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å, GigaChat –Ω–µ –æ–±–ª–∞–¥–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –º–Ω–µ–Ω–∏–µ–º"
    ]
    return any(phrase in response for phrase in blocked_phrases)

def get_payment_dates_fallback(question: str) -> str:
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –æ –¥–∞—Ç–∞—Ö –≤—ã–ø–ª–∞—Ç"""
    payment_keywords = [
        '–∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞', '–∑–∞—Ä–ø–ª–∞—Ç–∞', '–≤—ã–ø–ª–∞—Ç–∞', '–≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è', 
        '—Ä–∞—Å—á–µ—Ç', '—Ä–∞—Å—á–µ—Ç—ã', '–¥–Ω–∏ –≤—ã–ø–ª–∞—Ç', '—Å—Ä–æ–∫–∏ –≤—ã–ø–ª–∞—Ç', '–ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å'
    ]
    
    if any(keyword in question.lower() for keyword in payment_keywords):
        return """üìÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç–∞—Ö –≤—ã–ø–ª–∞—Ç**

–°–æ–≥–ª–∞—Å–Ω–æ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º:
‚Ä¢ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–Ω—è–º–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è **12-–µ** –∏ **27-–µ** —á–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞
‚Ä¢ –í—ã–ø–ª–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è **–¥–≤–∞ —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü**

*–ò—Å—Ç–æ—á–Ω–∏–∫: –ü—Ä–∞–≤–∏–ª–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç—Ä—É–¥–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞*"""
    
    return None

def test_responses():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤"""
    
    # –ü—Ä–∏–º–µ—Ä—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    blocked_responses = [
        "–ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –Ω–µ –æ–±–ª–∞–¥–∞—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –º–Ω–µ–Ω–∏–µ–º ‚Äî –∏—Ö –æ—Ç–≤–µ—Ç—ã —è–≤–ª—è—é—Ç—Å—è –æ–±–æ–±—â–µ–Ω–∏–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–∞—Ö–æ–¥—è—â–µ–π—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ. –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è, —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã –º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã.",
        "–ö–∞–∫ –∏ –ª—é–±–∞—è —è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å, GigaChat –Ω–µ –æ–±–ª–∞–¥–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –º–Ω–µ–Ω–∏–µ–º –∏ –Ω–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –º–Ω–µ–Ω–∏–µ —Å–≤–æ–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤. –û—Ç–≤–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–æ–π –º–æ–¥–µ–ª—å—é, –æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è –Ω–µ—Ç–æ—á–Ω–∞—è –∏–ª–∏ –æ—à–∏–±–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è, —Ä–∞–∑–≥–æ–≤–æ—Ä—ã –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–º—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã."
    ]
    
    # –ü—Ä–∏–º–µ—Ä—ã –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    normal_responses = [
        "–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç—É, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–Ω—è–º–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è 12-–µ –∏ 27-–µ —á–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞.",
        "–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–Ω—è–º–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º–∏ —è–≤–ª—è—é—Ç—Å—è **12-–µ** –∏ **27-–µ** —á–∏—Å–ª–∞ –º–µ—Å—è—Ü–∞."
    ]
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    test_questions = [
        "–°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç—Ä—É–¥–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞, –≤ –∫–∞–∫–∏–µ –¥–Ω–∏ –º–µ—Å—è—Ü–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞?",
        "–ö–∞–∫–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–Ω–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Å —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –ü–í–¢–†?",
        "12 –∏ 27 —á–∏—Å–ª–æ - —ç—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–Ω–∏ –≤—ã–ø–ª–∞—Ç?",
        "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å—Ä–æ–∫–∞—Ö –≤—ã–ø–ª–∞—Ç—ã –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –≤ –∫–æ–º–ø–∞–Ω–∏–∏",
        "–ö–∞–∫–∞—è –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –≤—ã–ø–ª–∞—Ç –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞?",
        "–ö–æ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–æ–ª–æ–≤–∞—è?"  # –ù–µ —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π –≤–æ–ø—Ä–æ—Å
    ]
    
    print("="*80)
    print("–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –§–ò–ù–ê–õ–¨–ù–û–ì–û –†–ï–®–ï–ù–ò–Ø")
    print("="*80)
    
    print("\n1. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ù–´–• –û–¢–í–ï–¢–û–í:")
    print("-" * 60)
    
    for i, response in enumerate(blocked_responses, 1):
        is_blocked = is_blocked_response(response)
        print(f"–û—Ç–≤–µ—Ç {i}: {'‚úÖ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù' if is_blocked else '‚ùå –ù–ï –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù'}")
        print(f"–¢–µ–∫—Å—Ç: {response[:100]}...")
        print()
    
    for i, response in enumerate(normal_responses, 1):
        is_blocked = is_blocked_response(response)
        print(f"–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç {i}: {'‚ùå –û–®–ò–ë–û–ß–ù–û –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù' if is_blocked else '‚úÖ –ù–ï –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù'}")
        print(f"–¢–µ–∫—Å—Ç: {response}")
        print()
    
    print("\n2. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–• –û–¢–í–ï–¢–û–í:")
    print("-" * 60)
    
    for i, question in enumerate(test_questions, 1):
        fallback = get_payment_dates_fallback(question)
        has_fallback = fallback is not None
        
        print(f"–í–æ–ø—Ä–æ—Å {i}: {'‚úÖ –ï–°–¢–¨ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê' if has_fallback else '‚ùå –ù–ï–¢ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–´'}")
        print(f"–¢–µ–∫—Å—Ç: {question}")
        if has_fallback:
            print(f"–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç: {fallback[:100]}...")
        print()
    
    print("\n3. –°–ò–ú–£–õ–Ø–¶–ò–Ø –ü–û–õ–ù–û–ì–û –ü–†–û–¶–ï–°–°–ê:")
    print("-" * 60)
    
    # –°–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
    for i, question in enumerate(test_questions[:4], 1):  # –ü–µ—Ä–≤—ã–µ 4 –≤–æ–ø—Ä–æ—Å–∞ –æ –∑–∞—Ä–ø–ª–∞—Ç–µ
        print(f"\n–í–û–ü–†–û–° {i}: {question}")
        
        # –°–∏–º—É–ª–∏—Ä—É–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
        blocked_response = blocked_responses[0]
        print("–û–¢–í–ï–¢ RAG: ‚ùå –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù")
        
        # –ü–æ–ª—É—á–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–≤–µ—Ç
        fallback = get_payment_dates_fallback(question)
        if fallback:
            print("–§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–í–ï–¢: ‚úÖ –ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ù–´–ô")
            print(fallback)
        else:
            print("–§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–í–ï–¢: ‚ö†Ô∏è –°–¢–ê–ù–î–ê–†–¢–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï –û–ë –û–®–ò–ë–ö–ï")
        
        print("-" * 40)
    
    print("\n" + "="*80)
    print("–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û")
    print("="*80)

if __name__ == "__main__":
    test_responses() 