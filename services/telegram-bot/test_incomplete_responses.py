#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–ø–æ–ª–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ GigaChat
"""

import os
import sys
from dotenv import load_dotenv

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç—å –∫ shared –º–æ–¥—É–ª—è–º
sys.path.append(os.path.join(os.path.dirname(__file__), '..', 'shared'))

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ handlers
from bot.handlers import is_blocked_response

def test_incomplete_responses():
    """–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ –∑–∞—Ä–ø–ª–∞—Ç–µ"""
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ GigaChat:")
    print("=" * 60)
    
    # –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç GigaChat
    test_responses = [
        # –ù–µ–ø–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
        """–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º, –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –¥–≤–∞ —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü. –°—Ä–æ–∫–∏ –≤—ã–ø–ª–∞—Ç—ã –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –∑–∞ –ø–µ—Ä–≤—É—é –∏ –∑–∞ –≤—Ç–æ—Ä—É—é –ø–æ–ª–æ–≤–∏–Ω—É –º–µ—Å—è—Ü–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Ç—Ä—É–¥–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ—Ä—è–¥–∫–∞ –û–±—â–µ—Å—Ç–≤–∞. –ü—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –¥–Ω—è –≤—ã–ø–ª–∞—Ç—ã —Å –≤—ã—Ö–æ–¥–Ω—ã–º –∏–ª–∏ –Ω–µ—Ä–∞–±–æ—á–∏–º –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–º –¥–Ω–µ–º, –≤—ã–ø–ª–∞—Ç–∞ –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–∞–∫–∞–Ω—É–Ω–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –¥–Ω—è –∏–ª–∏ –ø—Ä–∞–∑–¥–Ω–∏–∫–∞.""",
        
        # –ü–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç (–Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
        """–ó–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –¥–≤–∞ —Ä–∞–∑–∞ –≤ –º–µ—Å—è—Ü: 12-–≥–æ –∏ 27-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞.""",
        
        # –Ø–≤–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
        """–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –∏–Ω–æ–≥–¥–∞ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö. –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–æ–ª–∫–æ–≤–∞–Ω–∏—è, –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ç–µ–º–∞–º–∏, –≤—Ä–µ–º–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã.""",
        
        # –û–±—ã—á–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–µ –æ –∑–∞—Ä–ø–ª–∞—Ç–µ
        """–†–∞–±–æ—á–∏–π –¥–µ–Ω—å —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 8 —á–∞—Å–æ–≤ —Å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞ –ø–æ –ø—è—Ç–Ω–∏—Ü—É."""
    ]
    
    expected_results = [True, False, True, False]  # –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    
    for i, (response, expected) in enumerate(zip(test_responses, expected_results), 1):
        result = is_blocked_response(response)
        status = "‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û" if result == expected else "‚ùå –û–®–ò–ë–ö–ê"
        
        print(f"\nüß™ –¢–µ—Å—Ç {i}:")
        print(f"üìù –û—Ç–≤–µ—Ç: {response[:100]}...")
        print(f"üéØ –û–∂–∏–¥–∞–µ—Ç—Å—è: {'–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù' if expected else '–†–ê–ó–†–ï–®–ï–ù'}")
        print(f"üîç –†–µ–∑—É–ª—å—Ç–∞—Ç: {'–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù' if result else '–†–ê–ó–†–ï–®–ï–ù'}")
        print(f"üìä –°—Ç–∞—Ç—É—Å: {status}")
        print("-" * 60)

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è"""
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–ï–ü–û–õ–ù–´–• –û–¢–í–ï–¢–û–í GIGACHAT")
    print("=" * 80)
    
    test_incomplete_responses()
    
    print("\n‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")

if __name__ == "__main__":
    load_dotenv()
    main() 